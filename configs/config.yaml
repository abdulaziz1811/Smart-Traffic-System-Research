# ╔══════════════════════════════════════════════════════════╗
# ║  Smart Traffic Signal Control System — Configuration    ║
# ╚══════════════════════════════════════════════════════════╝

# ── Paths ────────────────────────────────────────────────
paths:
  images_dir: "data/raw/DETRAC-Images/DETRAC-Images"
  xml_dir: "data/annotations/DETRAC-Train-Annotations-XML/DETRAC-Train-Annotations-XML"
  annotations_dir: "data/annotations"
  weights_dir: "models/weights"
  results_dir: "outputs/results"
  log_dir: "outputs/logs"

# ── Dataset ──────────────────────────────────────────────
dataset:
  name: "UA-DETRAC"
  split_ratios: { train: 0.70, val: 0.15, test: 0.15 }
  # Class mapping (Compatible with trained DETR model)
  categories: { car: 1, bus: 2, van: 3, others: 4 }
  num_classes: 4
  id2label: { 1: "Car", 2: "Bus", 3: "Van", 4: "Others" }
  default_image_size: [960, 540]

# ── Augmentation ─────────────────────────────────────────
augmentation:
  horizontal_flip: 0.5
  brightness_contrast: 0.2
  crop_size: [480, 640] 

# ── Model (DETR) ─────────────────────────────────────────
model:
  backbone: "resnet50"
  pretrained_model: "facebook/detr-resnet-50"
  image_size: { shortest_edge: 480, longest_edge: 640 }
  image_mean: [0.485, 0.456, 0.406]
  image_std:  [0.229, 0.224, 0.225]

# ── Training ─────────────────────────────────────────────
training:
  seed: 42
  epochs: 15                 # Adjust based on local hardware capabilities
  batch_size: 8              # Lower this if running out of GPU memory
  gradient_accumulation: 4
  learning_rate: 1.0e-4
  weight_decay: 1.0e-4
  max_grad_norm: 0.1
  scheduler: "cosine"
  warmup_ratio: 0.05
  early_stopping: { enabled: true, patience: 5, min_delta: 0.001 }
  checkpointing: { keep_last_n: 3 }
  dataloader: { num_workers: 2, pin_memory: true, drop_last: true }

# ── Inference ────────────────────────────────────────────
inference:
  confidence_threshold: 0.5
  nms_threshold: 0.5

# ── Reinforcement Learning (RL) ──────────────────────────
rl:
  num_approaches: 4
  num_phases: 4
  env_config:
    render_mode: "rgb_array" # Use 'human' to see the simulation window locally
    max_steps: 1000
    green_duration: 30
    yellow_duration: 4
    red_duration: 2